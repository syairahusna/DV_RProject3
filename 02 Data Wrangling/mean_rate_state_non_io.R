nonio_df %>%  gather("nonio_rates", "nonio_value", 4:6) %>% select(ZIPCODE, state, nonio_rates, nonio_value) %>% group_by(state, nonio_rates) %>% summarise(mean_rate = mean(nonio_value)) %>% ggplot(aes(x = state, y=mean_rate, fill = nonio_rates, nonio_rates)) + geom_bar(stat= "identity", position=position_dodge()) + theme(axis.text.x=element_text(angle=90, size=15)) + coord_flip() + labs(x="State", y="Mean Rate ($)") + ggtitle('Non-Investor Owned Utilities: Mean Value For Each Rate By State') + theme(plot.title=element_text(size=15, face="bold", vjust=2))